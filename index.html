<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aventura de Escapada</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: 'Georgia', serif;
            background: #121212;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        #game {
            width: 600px;
            height: 400px;
            background: #1f1f1f;
            border: 4px solid #888;
            padding: 1rem;
            overflow-y: auto;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
            position: relative; /* A√±adido para posicionar el bot√≥n de reinicio */
        }

        .dialogo {
            margin: 1rem 0;
        }

        .opciones button {
            display: block;
            margin: 0.5rem 0;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            background: #282828;
            color: #fff;
            border: 1px solid #555;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .opciones button:hover {
            background: #444;
        }
        
        /* Estilo para el nuevo bot√≥n de volver a jugar */
        #replay-button {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            background: #5e3a8a;
            color: #fff;
            border: 1px solid #8e6ec2;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 5px;
        }

        #replay-button:hover {
            background: #7648b1;
        }
    </style>
</head>

<body>
    <h1>üîÆ El Viaje Comienza</h1>
    <div id="game"></div>

    <script>
        const juego = document.getElementById('game');

        const historia = [
            {
                texto: 'Despiertas en una biblioteca encantada. Un pergamino flota frente a ti. Dice: "Cada elecci√≥n que hagas revelar√° tu destino". ¬øQu√© haces primero?',
                opciones: [
                    { texto: 'Explorar la sala del fondo con luces c√°lidas', atributo: 'acogedor', siguiente: 1 },
                    { texto: 'Subir por una escalera estrecha hacia un balc√≥n oscuro', atributo: 'misterioso', siguiente: 2 }
                ]
            },
            {
                texto: 'En la sala hay una chimenea, un sof√° antiguo y un libro titulado "El descanso del viajero". Tambi√©n hay una ventana con vistas a un jard√≠n nevado.',
                opciones: [
                    { texto: 'Sentarte a leer el libro', atributo: 'tranquilo', siguiente: 3 },
                    { texto: 'Observar el jard√≠n desde la ventana', atributo: 'naturaleza', siguiente: 4 }
                ]
            },
            {
                texto: 'Desde el balc√≥n ves una torre lejana y un camino de piedras. Hay una cuerda que baja a un callej√≥n.',
                opciones: [
                    { texto: 'Ir hacia la torre', atributo: 'historia', siguiente: 4 },
                    { texto: 'Bajar al callej√≥n', atributo: 'urbano', siguiente: 5 }
                ]
            },
            {
                texto: 'El libro te transporta a una escena con aroma a caf√©, m√∫sica suave y alguien sirviendo un desayuno casero.',
                opciones: [
                    { texto: 'Unirte a la mesa y disfrutar del momento', atributo: 'relax', siguiente: 6 },
                    { texto: 'Explorar la cocina y ver c√≥mo lo preparan', atributo: 'curioso', siguiente: 6 }
                ]
            },
            {
                texto: 'Encuentras un elfo dom√©stico que te ofrece dos objetos: una br√∫jula oxidada y una flor azul brillante.',
                opciones: [
                    { texto: 'Tomar la br√∫jula', atributo: 'aventura', siguiente: 6 },
                    { texto: 'Tomar la flor', atributo: 'emocional', siguiente: 7 }
                ]
            },
            {
                texto: 'En el callej√≥n Jean Michel Basquiat pinta un mural. Te ofrece un pincel y dice: "Pinta lo que quieras ver".',
                opciones: [
                    { texto: 'Pintar un paisaje salvaje', atributo: 'naturaleza', siguiente: 7 },
                    { texto: 'Pintar un rinc√≥n de ciudad con vida', atributo: 'ciudad', siguiente: 7 }
                ]
            },
            {
                texto: 'Una voz en el aire susurra: "Quedan pocos pasos... Sigue lo que te haga sentir viva". Hay una puerta con luz y otra con sombra.',
                opciones: [
                    { texto: 'Cruzar la puerta con luz', atributo: 'luz', siguiente: 8 },
                    { texto: 'Entrar en la puerta sombr√≠a', atributo: 'sombra', siguiente: 8 }
                ]
            },
            {
                texto: 'Al tomar el objeto, todo a tu alrededor empieza a girar. Una melod√≠a antigua te gu√≠a hacia un t√∫nel iluminado por luci√©rnagas.',
                opciones: [
                    { texto: 'Seguir la melod√≠a', atributo: 'fantas√≠a', siguiente: 8 },
                    { texto: 'Explorar un sendero lateral entre √°rboles', atributo: 'retirada', siguiente: 8 }
                ]
            },
            {
                texto: 'Tu viaje est√° a punto de revelarte un lugar especial. El aire cambia, huele a nuevo y a antiguo a la vez. Sientes que todo encaja.',
                opciones: [
                    { texto: 'Descubrir el destino', siguiente: 'resultado' }
                ]
            }
        ];

        let estado = {
            atributos: []
        };

        function mostrarPaso(paso) {
            if (paso === 'resultado') {
                mostrarResultado();
                return;
            }
            const escena = historia[paso];
            juego.innerHTML = `
                <div class="dialogo">
                  <p>${escena.texto}</p>
                </div>
                <div class="opciones"></div>
              `;
            const contenedorOpciones = juego.querySelector('.opciones');
            escena.opciones.forEach(op => {
                const btn = document.createElement('button');
                btn.textContent = op.texto;
                btn.onclick = () => {
                    if (op.atributo) estado.atributos.push(op.atributo);
                    mostrarPaso(op.siguiente);
                };
                contenedorOpciones.appendChild(btn);
            });
        }

        function mostrarResultado() {
            const puntos = estado.atributos.reduce((acc, atr) => {
                acc[atr] = (acc[atr] || 0) + 1;
                return acc;
            }, {});

            let destino = 'Puy du fou';

            if (puntos.tranquilo && puntos.naturaleza) destino = 'Sierra de Cazorla üå≤';
            else if (puntos.ciudad && puntos.urbano) destino = 'M√°laga üêü';
            else if (puntos.historia && puntos.misterioso) destino = 'C√≥rdoba üïå';
            else if (puntos.relax && puntos.acogedor) destino = 'Sierra de Aracena üõèÔ∏è';
            else if (puntos.aventura && puntos.fantasia) destino = 'Comunidad Valenciana üèôÔ∏è';
            else if (puntos.emocional && puntos.retirada) destino = 'Ba√±os termanles de Granada üåÑ';
            else if (puntos.acogedor && puntos.curioso) destino = 'Un caf√© de especialidad en Oporto üìö';
            else if (puntos.acogedor && puntos.aventura) destino = 'Ruta por Sierra Nevada üöê';
            else if (puntos.naturaleza && puntos.fantasia) destino = 'Bosques de la Sierra de las Nieves üßö';
            else if (puntos.urbano && puntos.naturaleza) destino = 'El Parque del Retiro de Madrid üå≥';

            juego.innerHTML = `
                <h2>‚ú® Tu destino ha sido revelado</h2>
                <p style="font-size: 1.5rem; color: #f582ae">${destino}</p>
              `;

            // Crear y a√±adir el bot√≥n de reinicio
            const replayBtn = document.createElement('button');
            replayBtn.textContent = 'Volver a jugar';
            replayBtn.id = 'replay-button'; // Asignar ID para el CSS
            replayBtn.onclick = () => {
                // Reiniciar el estado y empezar de nuevo
                estado.atributos = [];
                mostrarPaso(0);
            };

            juego.appendChild(replayBtn);
        }

        mostrarPaso(0);
    </script>
</body>

</html>